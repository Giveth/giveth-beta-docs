(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{81:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return s})),n.d(t,"default",(function(){return b}));var i=n(3),a=n(7),o=(n(0),n(100)),r={id:"giveth-1-simulation",title:"Giveth 1 Simulation"},l={unversionedId:"giveth-1-simulation",id:"giveth-1-simulation",isDocsHomePage:!1,title:"Giveth 1 Simulation",description:"This project runs to fix conflicts between the Giveth-Feathers DB and network ( smart contracts)",source:"@site/docs/doc4-giveth-1-simulation.md",slug:"/giveth-1-simulation",permalink:"/docs/giveth-1-simulation",editUrl:"https://github.com/giveth/giveth-beta-docs/edit/master/docs/doc4-giveth-1-simulation.md",version:"current",sidebar:"docsSidebar",previous:{title:"Contributor Guide",permalink:"/docs/contributors"},next:{title:"Linke Preview",permalink:"/docs/link-preview"}},s=[{value:"Table of content",id:"table-of-content",children:[]},{value:"Getting Started",id:"getting-started",children:[{value:"Install",id:"install",children:[]},{value:"Run Script",id:"run-script",children:[]},{value:"What do this project",id:"what-do-this-project",children:[]}]}],c={rightToc:s};function b(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(i.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,Object(o.b)("a",Object(i.a)({parentName:"p"},{href:"https://github.com/Giveth/giveth-1-simulation"}),"This project")," runs to fix conflicts between the ",Object(o.b)("a",Object(i.a)({parentName:"p"},{href:"https://github.com/Giveth/feathers-giveth"}),"Giveth-Feathers")," DB and network ( smart contracts)\nand it runs twice a day in develop server with this crontab job"),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"0  */12 * * *   cd /home/deploy/giveth-1-simulation && NODE_ENV=develop /home/deploy/.nvm/versions/node/v10.23.0/bin/node /home/deploy/giveth-1-simulation/src/index.js >> /home/deploy/giveth-1-simulation/data/log/simulation-cron.log")),Object(o.b)("h2",{id:"table-of-content"},"Table of content"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(i.a)({parentName:"li"},{href:"#table-of-content"}),"Table of content")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(i.a)({parentName:"li"},{href:"#getting-started"}),"Getting Started"),Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(i.a)({parentName:"li"},{href:"#install"}),"Install")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(i.a)({parentName:"li"},{href:"#run-script"}),"Run Script")))),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(i.a)({parentName:"li"},{href:"#what-do-this-project"}),"What do this project"))),Object(o.b)("h2",{id:"getting-started"},"Getting Started"),Object(o.b)("h3",{id:"install"},"Install"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("h4",Object(i.a)({parentName:"li"},{id:"any-os"}),"Any OS"),Object(o.b)("ol",{parentName:"li"},Object(o.b)("li",{parentName:"ol"},"Click ",Object(o.b)("strong",{parentName:"li"},"Star")," on this repo near the top-right corner of this web page (if you want to)."),Object(o.b)("li",{parentName:"ol"},"Fork this repo by clicking ",Object(o.b)("strong",{parentName:"li"},"Fork")," button in top-right corner of this web page. Continue to follow instruction steps from your own ",Object(o.b)("strong",{parentName:"li"},"giveth-1-simulation")," repo."),Object(o.b)("li",{parentName:"ol"},"The rest of these steps must be done from your machine's command line. Clone your own ",Object(o.b)("strong",{parentName:"li"},"giveth-1-simulation"),' repo. Copy the link from the "Clone or download" button near the top right of this repo\'s home page.',Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",Object(i.a)({parentName:"pre"},{}),"git clone {paste your own repo link here}\n"))),Object(o.b)("li",{parentName:"ol"},"Change directories to ",Object(o.b)("inlineCode",{parentName:"li"},"giveth-1-simulation"),":",Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",Object(i.a)({parentName:"pre"},{}),"cd giveth-1-simulation\n"))),Object(o.b)("li",{parentName:"ol"},"Make sure you have ",Object(o.b)("a",Object(i.a)({parentName:"li"},{href:"https://nodejs.org/"}),"NodeJS")," (v10.23.0 or higher), ",Object(o.b)("a",Object(i.a)({parentName:"li"},{href:"https://www.yarnpkg.com/"}),"yarn")," (v0.27.5 or higher), and npm (5.4.1 or higher) installed."),Object(o.b)("li",{parentName:"ol"},"Install dependencies from within feathers-giveth directory:",Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",Object(i.a)({parentName:"pre"},{}),"npm install\n")))))),Object(o.b)("h3",{id:"run-script"},"Run Script"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"create a folder named config, and put ",Object(o.b)("inlineCode",{parentName:"li"},"develop.json")," in that\nwith these data")),Object(o.b)("pre",null,Object(o.b)("code",Object(i.a)({parentName:"pre"},{}),'{\n  "mongodb": "mongodb://localhost:27017/giveth-develop",\n  "givethFeathersUrl": "https://feathers.develop.giveth.io",\n  "logDir": "data/log",\n  "cacheDir": "data/cache",\n  "logLevel": "info",\n  "dryRun": false,\n  "updateNetworkCache": true,\n  "emailReport": false,\n  "emailSimulationError": false,\n  "givethDevMailList": [\n    "mranjbar.z2993@gmail.com"\n  ],\n  "dappMailerUrl": "Giveth dapp mailer url",\n  "dappMailerSecret": "SECRET NOT IN DEFAULT.JSON",\n  "blockchain": {\n    "requiredConfirmations": 6,\n    "nodeUrl": "wss://rinkeby.eth.aragon.network/ws",\n    "homeNodeUrl": "wss://ropsten.infura.io/ws/v3/{SECRET GET THIS FROM infura.io}",\n    "liquidPledgingAddress": "0xf0e0F5A752f69Ee6dCfEed138520f6821357dc32"\n  },\n  "tokenWhitelist": [\n    {\n      "name": "Ropsten ETH",\n      "address": "0x0",\n      "foreignAddress": "0x387871cf72c8CC81E3a945402b0E3A2A6C0Ed38a",\n      "symbol": "ETH",\n      "decimals": 6\n    },\n    { "name": "MiniMe Test Token",\n      "address": "0xE690E380740a682E2b8CEAEa33584Ea2cb59849E",\n      "foreignAddress": "0xe1DA0672bDBdBc469E82cCACCe9e4c7C79dAF6cf",\n      "symbol": "XDAI",\n      "decimals": 3,\n      "rateEqSymbol": "DAI"\n    }\n  ]\n\n}\n')),Object(o.b)("ol",{start:2},Object(o.b)("li",{parentName:"ol"},Object(o.b)("inlineCode",{parentName:"li"},"npm run build")," This transpile the project and generate an ",Object(o.b)("inlineCode",{parentName:"li"},"index.js")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("inlineCode",{parentName:"li"},"npm run start:develop"))),Object(o.b)("h3",{id:"what-do-this-project"},"What do this project"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Getting all events from network (and cache it to in next runs\njust get new ones)"),Object(o.b)("li",{parentName:"ul"},"Getting all states from network (and cache it to in next runs\njust get new ones)"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"Sync DACs"),": If there is any dac in network and for any reason\nit's not in feathers-giveth, it create these DACs"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"Sync Campaigns"),":  If there is any campaign in network and for any reason\nit's not in feathers-giveth, it create these Campaigns"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"Sync Milestones"),": If there is any milestone in network and for any reason\nit's not in feathers-giveth, it create these Milestones"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"Sync donations with network"),": if there is missing donations in DB\nor for any reason the donations stuck in ",Object(o.b)("inlineCode",{parentName:"li"},"Pending")," status\nit fixed it"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"Update donationsCounter"),": If there is any conflict in ",Object(o.b)("inlineCode",{parentName:"li"},"Milestone")," or ",Object(o.b)("inlineCode",{parentName:"li"},"Campaign")," or\n",Object(o.b)("inlineCode",{parentName:"li"},"Dac")," donationsCounter and it's not up to date, this script resolve that"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"Update milestone statuses"),": if the status of any milestone is not up to date and not synced with network,\nthe script will resolve that and update the milestone"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"Unset pendingAmountRemaining from committed donations"))))}b.isMDXComponent=!0}}]);